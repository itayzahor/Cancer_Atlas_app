<!DOCTYPE html>
<html>
<head>
    <title>Socioeconomic Analysis</title>
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='shared.css') }}">
    <link rel="stylesheet" type="text/css" href="{{ url_for('static', filename='socioeconomic_analysis.css') }}">
</head>
<body>
    <h1>Socioeconomic Analysis</h1>

    <!-- Form Section -->
    <form method="GET" action="/socioeconomic_analysis" class="form-section">
        <label for="cancer_type">Select Cancer Type:</label>
        <select id="cancer_type" name="cancer_type">
            <option value="-" {% if cancer_type == "-" %}selected{% endif %}>All Cancer Types</option>
            {% for site in cancer_types %}
            <option value="{{ site['id'] }}" {% if site['id']|int == cancer_type|int %}selected{% endif %}>
                {{ site['name'] }}
            </option>
            {% endfor %}
        </select>

        <!-- Socioeconomic Factor Dropdown -->
        <label for="factor">Select Socioeconomic Factor:</label>
        <select id="factor" name="factor">
            <option value="median_income" {% if factor == "median_income" %}selected{% endif %}>Median Income</option>
            <option value="unemployment_rate" {% if factor == "unemployment_rate" %}selected{% endif %}>Unemployment Rate</option>
            <option value="insurance_rate" {% if factor == "insurance_rate" %}selected{% endif %}>Insurance Rate</option>
        </select>

        <button type="submit" class="btn-submit">Submit</button>
    </form>

    <div>
        <h2>{{ factor.replace("_", " ").title() }} vs Cancer Mortality Rate</h2>
        <div>
            {{ plot_html | safe }}
        </div>
    </div>

    <!-- Flexbox Container for Plot and Analysis -->
    <div class="content">
        <!-- Scatter Plot Section -->
        <div class="plot-section">
            <h2>Scatter Plot</h2>
            {{ scatter_plot | safe }}
        </div>

        <!-- Analysis Text Section -->
        <div class="text-section">
            <h2>About the Analysis</h2>
            <p>
                This scatter plot visualizes the relationship between median income and cancer mortality rates for each state. 
                Each point represents a state, and the tooltip displays the state's name.
            </p>
            <p>
                Use the dropdown above to filter by specific cancer types. Selecting "All Cancer Types" will display the overall analysis across all cancers.
            </p>
            <p>
                Median Income is shown on the x-axis, and Cancer Mortality Rate (per 1,000 population) is shown on the y-axis.
            </p>
        </div>
    </div>

    <!-- Data Table Section -->
    <h2>Data Table</h2>
    <table border="1" class="data-table">
        <thead>
            <tr>
                <th>State</th>
                <th>Median Income ($)</th>
                <th>Mortality Rate (per 1,000)</th>
            </tr>
        </thead>
        <tbody>
            {% for row in data %}
            <tr>
                <td>{{ row['state'] }}</td>
                <td>{{ row['socioeconomic_factor'] }}</td>
                <td>{{ row['mortality_rate'] }}</td>
            </tr>
            {% endfor %}
        </tbody>
    </table>

    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
            line-height: 1.6;
        }

        h1, h2 {
            text-align: center;
        }

        .form-section {
            text-align: center;
            margin-bottom: 20px;
        }

        .btn-submit {
            padding: 10px 20px;
            background-color: #007BFF;
            color: white;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }

        .btn-submit:hover {
            background-color: #0056b3;
        }

        .content {
            display: flex;
            justify-content: space-between;
            margin-top: 30px;
        }

        .plot-section, .text-section {
            width: 45%;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin-top: 20px;
        }

        .data-table th, .data-table td {
            padding: 10px;
            text-align: center;
            border: 1px solid #ddd;
        }

        .data-table th {
            background-color: #f4f4f4;
        }
    </style>
</body>
</html>
