<form method="GET">
    <label for="cancer_type">Cancer Type:</label>
    <select id="cancer_type" name="cancer_type">
        <option value="-" {% if cancer_type == "-" %}selected{% endif %}>All</option>
        {% for site in cancer_types %}
            <option value="{{ site['id'] }}" {% if site['id']|int == cancer_type|int %}selected{% endif %}>
                {{ site['name'] }}
            </option>
        {% endfor %}
    </select>

    <label for="race_id">Race:</label>
    <select name="race_id" id="race_id">
        <option value="-" {% if race_id == "-" %}selected{% endif %}>All</option>
        {% for race in races %}
            <option value="{{ race['id'] }}" {% if race['id']|int == race_id|int %}selected{% endif %}>
                {{ race['name'] }}
            </option>
        {% endfor %}
    </select>

    <label for="year">Year:</label>
    <select name="year" id="year">
        <option value="-" {% if year == "-" %}selected{% endif %}>All</option>
        {% for y in years %}
            <option value="{{ y }}" {% if y|int == year|int %}selected{% endif %}>{{ y }}</option>
        {% endfor %}
    </select>


    <label for="is_female">Gender:</label>
    <select id="is_female" name="is_female" required>
        <option value="-" selected>All</option>
        {% for option in is_female_options %}
            <option value="{{ option.value }}" {% if option.value == is_female %}selected{% endif %}>
                {{ option.label }}
            </option>
        {% endfor %}
    </select>

    <label for="is_alive">Type:</label>
    <select id="is_alive" name="is_alive" required>
        <option value="-" selected>All</option>
        {% for option in is_alive_options %}
            <option value="{{ option.value }}" {% if option.value == is_alive %}selected{% endif %}>
                {{ option.label }}
            </option>
        {% endfor %}
    </select>
    <!-- Hidden field to track advanced filter visibility -->
    <input type="hidden" id="show_advanced" name="show_advanced" value="{{ show_advanced|default('false') }}">

    <!-- Toggle Advanced Filters -->
    <button type="button" onclick="toggleAdvancedFilters()">Advanced Filters</button>

    {% include "advanced_filters.html" %}

    <button type="submit">Submit</button>
</form>

<script>
    function toggleAdvancedFilters() {
        const filters = document.getElementById('advanced-filters');
        const showAdvancedInput = document.getElementById('show_advanced');

        if (filters.style.display === 'none') {
            filters.style.display = 'block';
            showAdvancedInput.value = 'true';
        } else {
            filters.style.display = 'none';
            showAdvancedInput.value = 'false';
        }
    }

    // Ensure visibility persists based on hidden input
    document.addEventListener('DOMContentLoaded', function () {
        const filters = document.getElementById('advanced-filters');
        const showAdvancedInput = document.getElementById('show_advanced');
        if (showAdvancedInput.value === 'true') {
            filters.style.display = 'block';
        } else {
            filters.style.display = 'none';
        }
    });
</script>